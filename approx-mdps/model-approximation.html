<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aditya Mahajan">
<meta name="dcterms.date" content="2023-12-24">
<meta name="keywords" content="infinite horizon, discounted cost, Lipschitz continuity, approximation bounds, state aggregation">
<meta name="description" content="ECES 506 (Stochastic Control and Decision Theory)">

<title>Course Notes - 23&nbsp; Model approximation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../risk-sensitive/risk-sensitive-utility.html" rel="next">
<link href="../approx-mdps/policy-loss.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../site_libs/quarto-contrib/nutshell-1.0.6/nutshell.js"></script>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script>
window.MathJax = {
  tex: {
    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
    processEscapes: true,
    tags: "ams",
    macros: {
      PR: "\\mathbb{P}",
      EXP: "\\mathbb{E}",
      IND: "\\mathbb{I}",
      ONES: "\\mathbb{1}",
      reals: "\\mathbb{R}",
      integers: "\\mathbb{Z}",
      BLANK: "\\mathfrak{E}",
      TRANS: "\\intercal",
      BELLMAN: "\\mathcal{B}",
      RICCATI: "\\mathcal{R}",
      GAIN: "\\mathcal{G}",
      GREEDY: "\\mathcal{G}",
      MISMATCH: "\\mathcal{D}",
      VEC: "\\operatorname{vec}",
      diag: "\\operatorname{diag}",
      ROWS: "\\operatorname{vec}",
      TR: "\\operatorname{Tr}",   
      SPAN: "\\operatorname{sp}",   
      DRE: "\\operatorname{DRE}",   
      DARE: "\\operatorname{DARE}",   
      LQR: "\\operatorname{LQR}",   
      ALPHABET: ["\\mathcal{#1}", 1],
      MATRIX: ["\\begin{bmatrix} #1 \\end{bmatrix}", 1],
      NORM: ["\\left\\lVert \\mathstrut #1 \\right\\rVert", 1],
      ABS: ["\\left\\lvert \\mathstrut #1 \\right\\rvert", 1],
      GRAD: "\\nabla"
    },
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  },
};
</script>
<script async="" data-id="101261731" src="//static.getclicky.com/js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../stochastic-control/index.html" rel="" target="">
 <span class="menu-text">Stochastic Control</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../multi-agent-systems/index.html" rel="" target="">
 <span class="menu-text">Multi-Agent Systems</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto tools-wide">
    <a href="https://github.com/adityam/stochastic-control" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../approx-mdps/approx-DP.html">Approx DP</a></li><li class="breadcrumb-item"><a href="../approx-mdps/model-approximation.html"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Model approximation</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About the course</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Stochastic Optimization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stochastic-optimization/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stochastic-optimization/newsvendor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The newsvendor problem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stochastic-optimization/certainty-equivalence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Certainty equivalence</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">MDPs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Finite horizon MDPs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/gambling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Optimal gambling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/inventory-management.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Inventory Management</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/monotone-mdps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Monotonicity of value function and optimal policies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/power-delay-tradeoff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Power-delay tradeoff in wireless communication</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/reward-shaping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Reward Shaping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/inf-horizon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Infinite horizon MDPs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/mdp-algorithms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">MDP algorithms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/inventory-management-revisited.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Inventory management (revisted)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/mobile-edge-computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Service Migration in Mobile edge computing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/computational-complexity-vi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Computational complexity of value interation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/martingale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Thirfty and equalizing policies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/linear-programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Linear programming formulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/lipschitz-mdps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Lipschitz MDPs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/periodic-mdps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Periodic MDPs</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">POMDPs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pomdps/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pomdps/sequential-hypothesis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Sequential hypothesis testing</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Approx DP</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../approx-mdps/approx-DP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Approximate dynamic programming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../approx-mdps/policy-loss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Upper bounds on policy loss</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../approx-mdps/model-approximation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Model approximation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Risk sensitive MDPs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../risk-sensitive/risk-sensitive-utility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Risk Sensitive Utility</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../risk-sensitive/risk-sensitive-mdps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Risk Sensitive MDPs</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Linear systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear-systems/lqr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Linear quadratic regulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear-systems/large-scale-systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Large scale systems</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">RL</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rl/stochastic-approximation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Stochastic approximation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
 <span class="menu-text">Probability Appendix</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability/convergence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Convergence of random variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability/sub-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Sub-Gaussian random variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability/change-of-measure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Change of Measure</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability/martingales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Martingales</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability/IPM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Integral Probablity Metrics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability/stochastic-stability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Stochastic stability</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
 <span class="menu-text">Linear Algebra Appendix</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear-algebra/matrix-relationships.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Some useful matrix relationships</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear-algebra/positive-definite-matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Positive definite matrices</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear-algebra/svd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Singular value decomposition</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear-algebra/rkhs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Reproducing Kernel Hilbert Space</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
 <span class="menu-text">Convexity Appendix</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../convexity/convexity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Convex sets and convex functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../convexity/duality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Duality</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 1</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#bounds-for-model-approximation" id="toc-bounds-for-model-approximation" class="nav-link active" data-scroll-target="#bounds-for-model-approximation"><span class="header-section-number">23.1</span> Bounds for model approximation</a>
  <ul class="collapse">
  <li><a href="#value-error" id="toc-value-error" class="nav-link" data-scroll-target="#value-error"><span class="header-section-number">23.1.1</span> Policy and value error bounds</a></li>
  <li><a href="#model-approximation-error" id="toc-model-approximation-error" class="nav-link" data-scroll-target="#model-approximation-error"><span class="header-section-number">23.1.2</span> Model approximation error</a></li>
  </ul></li>
  <li><a href="#ipm-based-bounds-on-model-approximation-error" id="toc-ipm-based-bounds-on-model-approximation-error" class="nav-link" data-scroll-target="#ipm-based-bounds-on-model-approximation-error"><span class="header-section-number">23.2</span> IPM based bounds on model approximation error</a></li>
  <li><a href="#example-inventory" id="toc-example-inventory" class="nav-link" data-scroll-target="#example-inventory"><span class="header-section-number">23.3</span> Example: Inventory management with incorrect demand distribution</a></li>
  <li><a href="#example-certainty-equivalence" id="toc-example-certainty-equivalence" class="nav-link" data-scroll-target="#example-certainty-equivalence"><span class="header-section-number">23.4</span> Example: Performance loss in using certainty equivalent control</a></li>
  <li><a href="#notes" id="toc-notes" class="nav-link" data-scroll-target="#notes">Notes</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/adityam/stochastic-control/edit/quarto/approx-mdps/model-approximation.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Model approximation</span></h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="http://www.cim.mcgill.ca/~adityam">Aditya Mahajan</a> </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="http://www.mcgill.ca/ece">
            McGill University
            </a>
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Updated</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 24, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>There are many instances where approximate models are used. For example, in many applications with large state spaces, one often construct a simulation model of the system and use it to identify an optimal policy using simulation based methods (such as reinforcement learning). Often, the simulation model is only an approximation of the true model. In such instances, we want to know the error in using the policy obtained from the simulation model in the real world. In this section, we present bounds on such <em>sim-to-real</em> transfer.</p>
<p>Consider an MDP <span class="math inline">\(\ALPHABET M = \langle \ALPHABET S, \ALPHABET A, P, c, γ \rangle\)</span>. Suppose the components <span class="math inline">\(\langle \ALPHABET S, \ALPHABET A, γ \rangle\)</span> are known exactly but the components <span class="math inline">\((P,c)\)</span> are known approximately. Consider the approximate MDP <span class="math inline">\(\widehat {\ALPHABET M} = \langle \ALPHABET S, \ALPHABET A, \hat P, \hat c, γ \rangle\)</span>. We will call <span class="math inline">\(\ALPHABET M\)</span> to be the <em>true model</em> and <span class="math inline">\(\widehat {\ALPHABET M}\)</span> to be the <em>approximate model</em>.</p>
<p>Let <span class="math inline">\(V^*\)</span> and <span class="math inline">\(\hat V^*\)</span> denote the optimal value functions of the true model <span class="math inline">\(\ALPHABET M\)</span> and the approximate model <span class="math inline">\(\widehat {\ALPHABET M}\)</span>, respectively. Moreover, let <span class="math inline">\(π^*\)</span> and <span class="math inline">\(\hat π^*\)</span> be optimal policies for the true model <span class="math inline">\(\ALPHABET M\)</span> and the approximate model <span class="math inline">\(\widehat {\ALPHABET M}\)</span>, respectively.</p>
<p>We are interested in the following questions:</p>
<ol type="1">
<li><p><strong>Policy error bounds:</strong> Given a policy <span class="math inline">\(π\)</span>, what is the error if <span class="math inline">\(\hat V^π\)</span> is used as an approximation for <span class="math inline">\(V^π\)</span>?</p></li>
<li><p><strong>Value error bounds:</strong> What is the error if <span class="math inline">\(\hat V^*\)</span> is used as an approximation for <span class="math inline">\(V^*\)</span>?</p></li>
<li><p><strong>Model approximation error:</strong> What is the error if the policy <span class="math inline">\(\hat π^*\)</span> is used instead of the optimal policy <span class="math inline">\(π^*\)</span></p></li>
</ol>
<section id="bounds-for-model-approximation" class="level2" data-number="23.1">
<h2 data-number="23.1" class="anchored" data-anchor-id="bounds-for-model-approximation"><span class="header-section-number">23.1</span> Bounds for model approximation</h2>
<section id="value-error" class="level3" data-number="23.1.1">
<h3 data-number="23.1.1" class="anchored" data-anchor-id="value-error"><span class="header-section-number">23.1.1</span> Policy and value error bounds</h3>
<p>Let <span class="math inline">\(\BELLMAN^π\)</span> and <span class="math inline">\(\BELLMAN^*\)</span> denote the Bellman operator for policy <span class="math inline">\(π\)</span> and the optimality Bellman operator for model <span class="math inline">\(\ALPHABET M\)</span>. Let <span class="math inline">\(\hat {\BELLMAN}^π\)</span> and <span class="math inline">\(\hat {\BELLMAN}^*\)</span> denote the corresponding quantities for model <span class="math inline">\(\widehat {\ALPHABET M}\)</span>. Define the <em>Bellman mismatch functionals</em> <span class="math inline">\(\MISMATCH^π\)</span> and <span class="math inline">\(\MISMATCH^*\)</span> as follows: <span class="math display">\[\begin{align*}
  \MISMATCH^π v &amp;= \| \BELLMAN^π v - \hat {\BELLMAN}^π v \|_∞,
  \\
  \MISMATCH^* v &amp;= \| \BELLMAN^* v - \hat {\BELLMAN}^* v \|_∞ .
\end{align*}\]</span></p>
<p>Also define the <em>maximum Bellman mismatch</em> as <span class="math display">\[\begin{align*}
  \MISMATCH^{\max} v &amp;=
  \max_{(s,a) \in \ALPHABET S, A} \biggl\lvert
    c(s,a) + γ \sum_{s' \in \ALPHABET S} P(s'|s,a)v(s')  \notag \\
  &amp; \hskip 6em
   -\hat c(s,a) - γ \sum_{s' \in \ALPHABET S} \hat P(s'|s,a) v(s')
   \biggr\rvert.
\end{align*}\]</span></p>
<div id="lem-mismatch-bellman" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 23.1 </strong></span>The following inequalities hold:</p>
<ul>
<li><span class="math inline">\(\sup_{π \in Π} \MISMATCH^π v = \MISMATCH^{\max} v\)</span></li>
<li><span class="math inline">\(\MISMATCH^* v \le \MISMATCH^{\max} v\)</span>.</li>
</ul>
</div>
<p>The Bellman mismatch functional can be used to bound the performance difference of a policy between the true and approximate models.</p>
<div id="prp-policy-error" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 23.1 (Policy error) </strong></span>For any (possibly randomized) policy <span class="math inline">\(π\)</span>, <span class="math display">\[\begin{equation}\label{eq:policy-error}
   \| V^{π} - \hat V^{π} \|_∞ \le
   \frac{1}{1-γ} \min\{ \MISMATCH^π V^{π}, \MISMATCH^π \hat V^{π} \}.
\end{equation}\]</span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We bound the left hand side of \eqref{eq:policy-error} in two ways. The first way is as follows: <span class="math display">\[\begin{align}
  \| V^{π} - \hat V^{π} \|_∞
  &amp;=
  \| \BELLMAN^π V^π - \hat {\ALPHABET  B}^π \hat V^π \|_∞
  \notag \\
  &amp;\le
  \| \BELLMAN^π V^π - \hat {\ALPHABET  B}^π V^π \|_∞
  +
  \| \hat {\BELLMAN}^π V^π - \hat {\ALPHABET  B}^π \hat V^π \|_∞
  \notag \\
  &amp;\le
  \MISMATCH^π V^π + γ \| V^π - \hat V^π \|_∞
  \label{eq:ineq-3}
\end{align}\]</span> where the first inequality follows from the triangle inequality, and the second inequality follows from the definition of the Bellman mismatch functional and the contraction property of Bellman operators. Rearranging terms in&nbsp;\eqref{eq:ineq-3} gives us <span class="math display">\[\begin{equation}
\| V^{π} - \hat V^{π} \|_∞ \le \frac{ \MISMATCH^π V^{π}}{1 - γ}.
\label{eq:ineq-4}\end{equation}\]</span> This gives the first bound.</p>
<p>The second bound is symmetric and obtained by interchanging the roles of <span class="math inline">\(V^π\)</span> and <span class="math inline">\(\hat V^π\)</span>. <span class="math display">\[\begin{align}
  \| V^{π} - \hat V^{π} \|_∞
  &amp;=
  \| \BELLMAN^π V^π - \hat {\ALPHABET  B}^π \hat V^π \|_∞
  \notag \\
  &amp;\le
  \| \BELLMAN^π V^π - \ALPHABET  B^π \hat V^π \|_∞
  +
  \| \BELLMAN^π \hat V^π - \hat {\ALPHABET  B}^π \hat V^π \|_∞
  \notag \\
  &amp;\le
  γ \| V^π - \hat V^π \|_∞
  +
  \MISMATCH^π \hat V^π
  \label{eq:ineq-13}
\end{align}\]</span> Rearranging terms in&nbsp;\eqref{eq:ineq-13} gives us <span class="math display">\[\begin{equation}
\| V^{π} - \hat V^{π} \|_∞ \le \frac{ \MISMATCH^π \hat V^{π}}{1 - γ}.
\label{eq:ineq-14}\end{equation}\]</span> This gives the second bound.</p>
</div>
</div>
</div>
<p>Similar to the above, we can also bound the difference between the optimal value function of the true and approximate models.</p>
<div id="prp-value-error" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 23.2 (Value error) </strong></span>Let <span class="math inline">\(V^*\)</span> and <span class="math inline">\(\hat V^*\)</span> denote the optimal value functions for <span class="math inline">\(\ALPHABET M\)</span> and <span class="math inline">\(\widehat {\ALPHABET M}\)</span>, respectively. Then, <span class="math display">\[\begin{equation}\label{eq:value-error}
    \| V^* - \hat V^* \|_∞ \le
    \frac{1}{1-γ} \min\{ \MISMATCH^* V^*, \MISMATCH^* \hat V^* \}
\end{equation}\]</span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The proof argument is almost the same as the proof argument for <a href="#prp-policy-error">Proposition&nbsp;<span>23.1</span></a>. The first was is as follows: <span class="math display">\[\begin{align}
  \| V^{*} - \hat V^{*} \|_∞
  &amp;=
  \| \BELLMAN^* V^* - \hat {\ALPHABET  B}^* \hat V^* \|_∞
  \notag \\
  &amp;\le
  \| \BELLMAN^* V^* - \hat {\ALPHABET  B}^* V^* \|_∞
  +
  \| \hat {\BELLMAN}^* V^* - \hat {\ALPHABET  B}^* \hat V^* \|_∞
  \notag \\
  &amp;\le
  \MISMATCH^* V^* + γ \| V^* - \hat V^* \|_∞
  \label{eq:ineq-1}
\end{align}\]</span> where the first inequality follows from the triangle inequality, and the second inequality follows from the definition of the Bellman mismatch functional and the contraction property of Bellman operators. Rearranging terms in&nbsp;\eqref{eq:ineq-1} gives us <span class="math display">\[\begin{equation}
\| V^* - \hat V^* \|_∞ \le \frac{  \MISMATCH^* V^*}{1 - γ}.
\label{eq:ineq-2}\end{equation}\]</span> This gives the first bound.</p>
<p>The second bound is symmetric and obtained by interchanging the roles of <span class="math inline">\(V^*\)</span> and <span class="math inline">\(\hat V^*\)</span>. <span class="math display">\[\begin{align}
  \| V^{*} - \hat V^{*} \|_∞
  &amp;=
  \| \BELLMAN^* V^* - \hat {\ALPHABET  B}^* \hat V^* \|_∞
  \notag \\
  &amp;\le
  \| \BELLMAN^* V^* - \ALPHABET  B^* \hat V^* \|_∞
  +
  \| \BELLMAN^* \hat V^* - \hat {\ALPHABET  B}^* \hat V^* \|_∞
  \notag \\
  &amp;\le
  γ \| V^* - \hat V^* \|_∞
  +
  \MISMATCH^* \hat V^*
  \label{eq:ineq-11}
\end{align}\]</span> Rearranging terms in&nbsp;\eqref{eq:ineq-11} gives us <span class="math display">\[\begin{equation}
\| V^{*} - \hat V^{*} \|_∞ \le \frac{ \MISMATCH^* \hat V^{*}}{1 - γ}.
\label{eq:ineq-12}\end{equation}\]</span> This gives the second bound.</p>
</div>
</div>
</div>
</section>
<section id="model-approximation-error" class="level3" data-number="23.1.2">
<h3 data-number="23.1.2" class="anchored" data-anchor-id="model-approximation-error"><span class="header-section-number">23.1.2</span> Model approximation error</h3>
<p>To bound the model error, we observe that from triangle inequality we have <span class="math display">\[\begin{equation} \label{eq:triangle-1}
  \| V^* - V^{\hat π^*} \|_∞ \le
  \| V^* - \hat V^{\hat π^*} \|_∞
  +
  \| V^{\hat π^*} - \hat V^{\hat π^*} \|_∞.
\end{equation}\]</span></p>
<p><a href="#prp-policy-error">Proposition&nbsp;<span>23.1</span></a> and <a href="#prp-value-error">Proposition&nbsp;<span>23.2</span></a> provide bounds of both of the terms of <span class="math inline">\(\eqref{eq:triangle-1}\)</span>. Choosing appropriate values for both terms gives us the following</p>
<div id="thm-model-error-hat-V-star" class="theorem">
<p><span class="theorem-title"><strong>Theorem 23.1 (Model approximation error) </strong></span>The policy <span class="math inline">\(\hat π^*\)</span> is an <span class="math inline">\(α\)</span>-optimal policy of <span class="math inline">\(\ALPHABET M\)</span> where <span class="math display">\[
    α := \| V^* - V^{\hat π^*} \|_∞ \le
    \frac{1}{1-γ} \bigl[ \MISMATCH^* \hat V^* + \MISMATCH^{\hat
    π^*} \hat V^* \bigr].
\]</span> Moreover, since <span class="math inline">\(\MISMATCH^{\max} \hat V^*\)</span> is an upper bound for both <span class="math inline">\(\MISMATCH^{\hat π^*} \hat V^*\)</span> and <span class="math inline">\(\MISMATCH^* \hat V^*\)</span>, we have <span class="math display">\[
    α \le \frac{2}{(1-γ)}  \MISMATCH^{\max}  \hat V^*.
\]</span></p>
</div>
<p>In some applications, it is useful to have a model-error bound that depends on <span class="math inline">\(V^*\)</span> rather than <span class="math inline">\(\hat V^*\)</span>. We provide such a bound below.</p>
<div id="thm-model-error-V-star" class="theorem">
<p><span class="theorem-title"><strong>Theorem 23.2 (Model approximation error) </strong></span>The policy <span class="math inline">\(\hat π^*\)</span> is an <span class="math inline">\(α\)</span>-optimal policy of <span class="math inline">\(\ALPHABET M\)</span> where <span class="math display">\[
    α := \| V^* - V^{\hat π^*} \|_∞ \le
    \frac{1}{1-γ} \MISMATCH^{\hat π^*} V^*
    +
    \frac{(1+γ)}{(1-γ)^2} \MISMATCH^* V^* .
\]</span></p>
<p>Moreover, since <span class="math inline">\(\MISMATCH^{\max} V^*\)</span> is an upper bound for both <span class="math inline">\(\MISMATCH^{\hat π^*} V^*\)</span> and <span class="math inline">\(\MISMATCH^* V^*\)</span>, we have <span class="math display">\[
    α \le \frac{2}{(1-γ)^2}  \MISMATCH^{\max}  V^*.
\]</span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We bound the first term of <span class="math inline">\(\eqref{eq:triangle-1}\)</span> by <a href="#prp-value-error">Proposition&nbsp;<span>23.2</span></a> But instead of bounding the second term of <span class="math inline">\(\eqref{eq:triangle-1}\)</span> by <a href="#prp-policy-error">Proposition&nbsp;<span>23.1</span></a>, we consider the following: <span class="math display">\[\begin{align}
  \| V^{\hat π^*} - \hat V^{\hat π^*} \|_∞
  &amp;=
  \| V^{\hat π^*} - \hat V^{*} \|_∞
  = \| \BELLMAN^{\hat π^*} V^{\hat π^*} -
       \hat {\BELLMAN}^{\hat π^*} \hat V^{*} \|_∞
  \notag \\
  &amp;\le \| \BELLMAN^{\hat π^*} V^{\hat π^*} -
          \BELLMAN^{\hat π^*} V^{*} \|_∞
    +  \| \BELLMAN^{\hat π^*} V^{*} -
       \hat {\BELLMAN}^{\hat π^*} V^{*} \|_∞
    +
       \| \hat {\BELLMAN}^{\hat π^*} V^{*} -
       \hat {\BELLMAN}^{\hat π^*} \hat V^{*} \|_∞
  \notag \\
  &amp;\le γ \| V^* - V^{\hat π^*} \|_∞ + \MISMATCH^{\hat π^*} V^*
  + γ \| V^* - \hat V^* \|_∞
  \label{eq:ineq-21}.
\end{align}\]</span> where the first inequality follows from the triangle inequality and the second inequality follows from the definition of Bellman mismatch functional and contraction property of Bellman operator.</p>
<p>Substituting <span class="math inline">\(\eqref{eq:ineq-21}\)</span> in <span class="math inline">\(\eqref{eq:triangle-1}\)</span> and rearranging terms, we get <span class="math display">\[\begin{align}
  \| V^* - V^{\hat π^*} \|_∞
  &amp;\le
  \frac{1}{1-γ} \MISMATCH^{\hat π^*} V^*
  +
  \frac{1+γ}{1-γ} \| V^* - \hat V^* \|_∞
  \notag \\
  &amp;\le
  \frac{1}{1-γ} \MISMATCH^{\hat π^*} V^*
  +
  \frac{(1+γ)}{(1-γ)^2} \MISMATCH^* V^* .
\end{align}\]</span> where the second inequality follows from <a href="#prp-value-error">Proposition&nbsp;<span>23.2</span></a>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Remark:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that the bound of <a href="#thm-model-error-V-star">Theorem&nbsp;<span>23.2</span></a> is tighter by a factor of <span class="math inline">\(1/(1-γ)\)</span> but that bound is in terms of <span class="math inline">\(\hat V^*\)</span>. In some settings, a bound in terms of <span class="math inline">\(V^*\)</span> is more desirable. Using <a href="#thm-model-error-hat-V-star">Theorem&nbsp;<span>23.1</span></a> in such settings leads to scaling by <span class="math inline">\(1/(1-γ)\)</span>.</p>
</div>
</div>
</section>
</section>
<section id="ipm-based-bounds-on-model-approximation-error" class="level2" data-number="23.2">
<h2 data-number="23.2" class="anchored" data-anchor-id="ipm-based-bounds-on-model-approximation-error"><span class="header-section-number">23.2</span> IPM based bounds on model approximation error</h2>
<p>Sometimes, it is easier to think in terms of explicit bounds between the models. For example, we may characterize the error between models <span class="math inline">\(\ALPHABET M\)</span> and <span class="math inline">\(\hat {\ALPHABET M}\)</span> as the distance between their cost functions and transition dynamics. For formalize this notion, we need to specify a metric on probability spaces. It turns out that <a href="../probability/IPM.html">integral probability metrics (IPM)</a> are ideally suited for this task.</p>
<p>Let <span class="math inline">\(\def\F{\mathfrak{F}}\F\)</span> be a convex and balanced set of functions from <span class="math inline">\(\ALPHABET S\)</span> to <span class="math inline">\(\reals\)</span>. Then, the IPM distance (w.r.t. <span class="math inline">\(\F\)</span>) between two probability laws <span class="math inline">\(μ_1\)</span> and <span class="math inline">\(μ_2\)</span> is given by <span class="math display">\[
  d_{\F}(ν_1, ν_2) = \sup_{f \in \F}
  \left| \int f d μ_1 - \int f d μ_2 \right|.
\]</span> For our discussion, we will assume that <span class="math inline">\(\F\)</span> is a maximal generator. See <a href="../probability/IPM.html#maximal-generators">the notes on IPM</a> for more details, in particular the notion of <a href="../probability/IPM.html#Minkowski">gauge or Minkowski functional <span class="math inline">\(ρ_{\F}\)</span></a> of an IPM and <a href="../probability/IPM.html#prp-IPM-ineq">Proposition&nbsp;<span>33.4</span></a>, which states that for any function <span class="math inline">\(f\)</span>, <span class="math display">\[\begin{equation}\label{eq:IPM-ineq}
  \left| \int f d μ_1 - \int f d μ_2 \right|
  \le
  ρ_{\F}(f) d_{\F}(μ_1, μ_2).
\end{equation}\]</span></p>
<p>Now, we define a notion of distance between models.</p>
<div id="def-model-distance" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 23.1 </strong></span>Given a function class <span class="math inline">\(\F\)</span>, we say that a model <span class="math inline">\(\hat {\ALPHABET M}\)</span> is an <span class="math inline">\((ε,δ)\)</span>-approximation of model <span class="math inline">\(\ALPHABET M\)</span> if for all <span class="math inline">\((s,a) \in \ALPHABET S × \ALPHABET A\)</span>, we have:</p>
<ol type="1">
<li><span class="math inline">\(\ABS{ c(s,a) - \hat c(s,a) } \le ε\)</span></li>
<li><span class="math inline">\(d_{\F}( P(\cdot \mid s,a) , \hat P(\cdot \mid s,a) ) \le δ\)</span>.</li>
</ol>
</div>
<p>Note that given any two models <span class="math inline">\(\ALPHABET M\)</span> and <span class="math inline">\(\hat {\ALPHABET M}\)</span>, we can always say that <span class="math inline">\(\hat {\ALPHABET M}\)</span> is an <span class="math inline">\((ε,δ)\)</span> approximation of <span class="math inline">\(\ALPHABET M\)</span> with <span class="math display">\[
ε = \NORM{ c - \hat c }_{∞}
\quad\text{and}\quad
δ = \sup_{(s,a) \in \ALPHABET S × \ALPHABET A}
    d_{\F}( P(\cdot \mid s,a) , \hat P(\cdot \mid s,a) ).
\]</span></p>
<p>An immediate implication of the above definition is the following.</p>
<div id="lem-IPM-bound-on-mismatch" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 23.2 </strong></span>If <span class="math inline">\(\hat {\ALPHABET M}\)</span> is an <span class="math inline">\((ε,δ)\)</span> approximation of <span class="math inline">\(\ALPHABET M\)</span> with respect to <span class="math inline">\(\F\)</span>, then for any <span class="math inline">\(v \colon \ALPHABET S \to \reals\)</span> <span class="math display">\[
  \MISMATCH^{\max} v \le ε + γ δ \, ρ_{\F}(v).
\]</span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>From the definition of maximum Bellman mismatch, we have <span class="math display">\[\begin{align*}
  \MISMATCH^{\max} v &amp;=
  \max_{(s,a) \in \ALPHABET S, A} \biggl\lvert
    c(s,a) + γ \sum_{s' \in \ALPHABET S} P(s'|s,a)v(s')
   -\hat c(s,a) - γ \sum_{s' \in \ALPHABET S} \hat P(s'|s,a) v(s')
   \biggr\rvert
  \\
  &amp;\stackrel{(a)}\le
  \max_{(s,a) \in \ALPHABET S, A}
  \bigg\{
  \bigl\lvert c(s,a) - \hat c(s,a) \bigr\rvert
  +
  γ \biggl\lvert
  \sum_{s' \in \ALPHABET S} P(s' | s,a) v(s')
  -
  \sum_{s' \in \ALPHABET S} \hat P(s' | s,a) v(s')
  \biggr|
  \biggr\}
  \\
  &amp;\stackrel{(b)}\le
  \max_{(s,a) \in \ALPHABET S, A} \Bigl\{
  \bigl\lvert c(s,a) - \hat c(s,a) \bigr\rvert
  + γ ρ_{\F}(v)
  d_{\F}(P(\cdot | s,a), \hat P(\cdot | s,a) )
  \Bigr\}
  \notag \\
  &amp;\stackrel{(c)}\le ε + γ δ ρ_{\F}(v)
\end{align*}\]</span> where <span class="math inline">\((a)\)</span> follows from triangle inequality, <span class="math inline">\((b)\)</span> follows from <span class="math inline">\(\eqref{eq:IPM-ineq}\)</span> and <span class="math inline">\((c)\)</span> follows from the definition of <span class="math inline">\((ε,δ)\)</span>.</p>
</div>
</div>
</div>
<p>An immediate consequence of <a href="#lem-IPM-bound-on-mismatch">Lemma&nbsp;<span>23.2</span></a> when combined with <a href="#thm-model-error-V-star">Theorem&nbsp;<span>23.2</span></a> and <a href="#thm-model-error-hat-V-star">Theorem&nbsp;<span>23.1</span></a> is the following.</p>
<div id="thm-model-error-IPM" class="theorem">
<p><span class="theorem-title"><strong>Theorem 23.3 (Model approximation error) </strong></span>If model <span class="math inline">\(\hat {\ALPHABET M}\)</span> is an <span class="math inline">\((ε,δ)\)</span>-approximation of model <span class="math inline">\(\ALPHABET M\)</span>, then the policy <span class="math inline">\(\hat π^*\)</span> is an <span class="math inline">\(α\)</span>-optimal policy of <span class="math inline">\(\ALPHABET M\)</span> where <span class="math display">\[
    α := \| V^* - V^{\hat π^*} \|_∞ \le
    \frac{2}{1-γ} \bigl[ ε + γ δ ρ_{\F}(\hat V^*)\bigr].
\]</span> Another upper bound on <span class="math inline">\(α\)</span> is <span class="math display">\[
    α  \le
    \frac{2}{(1-γ)^2} \bigl[ ε + γ δ ρ_{\F}(V^*)\bigr].
\]</span></p>
</div>
<p>Note that the above bounds require the knowledge of <span class="math inline">\(\hat V^*\)</span>. For specific choices of IPM, it is possible to obtain bounds which do not require the knowledge of <span class="math inline">\(\hat V^*\)</span>. We can get looser upper bounds which do not require explicit knowledge of <span class="math inline">\(\hat V^*\)</span>.</p>
<div id="cor-model-error-instance-independent" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 23.1 (Instance independent model approximation error bounds) </strong></span>&nbsp;</p>
<ol type="1">
<li><p>If model <span class="math inline">\(\hat {\ALPHABET M}\)</span> is an <span class="math inline">\((ε,δ)\)</span>-approximation of model <span class="math inline">\(\ALPHABET M\)</span> with respect to total variation, then the policy <span class="math inline">\(\hat π^*\)</span> is an <span class="math inline">\(α\)</span>-optimal policy of <span class="math inline">\(\ALPHABET M\)</span> where <span class="math display">\[
  α \le \frac{2 ε}{1-γ} + \frac{ γ δ\SPAN(\hat r)}{(1-γ)^2},
\]</span> or <span class="math display">\[
  α \le \frac{2 ε}{(1-γ)^2} + \frac{ γ δ\SPAN(r)}{(1-γ)^3}.
\]</span></p></li>
<li><p>If the approximation is with respect the the Wasserstein distance, then we have the following:</p>
<ol type="a">
<li>If the approximate model <span class="math inline">\(\hat {\ALPHABET M}\)</span> is <span class="math inline">\((\hat L_r, \hat L_P)\)</span> Lipschitz (see <a href="../mdps/lipschitz-mdps.html#def-lipschitz-mdp">Definition&nbsp;<span>17.1</span></a>) with <span class="math inline">\(γ \hat L_P &lt; 1\)</span>, then <span class="math display">\[
  α \le \frac{2}{1-γ}\biggl[
  ε + \frac{γ δ\hat L_r}{1 - γ \hat L_{P}} \biggr]
\]</span></li>
<li>If the original model <span class="math inline">\({\ALPHABET M}\)</span> is <span class="math inline">\((L_r, L_P)\)</span> Lipschitz with <span class="math inline">\(γ L_P &lt; 1\)</span>, then <span class="math display">\[
  α \le \frac{2}{(1-γ)^2}\biggl[
  ε + \frac{γ δ L_r}{1 - γ L_{P}} \biggr]
\]</span></li>
</ol></li>
</ol>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>The result follows from <a href="#thm-model-error-IPM">Theorem&nbsp;<span>23.3</span></a> the observation that <span class="math inline">\(\SPAN(\hat V^*) \le (1-γ)^{-1} \SPAN(\hat r)\)</span> and <span class="math inline">\(\SPAN(V^*) \le (1-γ)^{-1} \SPAN(r)\)</span>.</p></li>
<li><p>The result follows from <a href="#thm-model-error-IPM">Theorem&nbsp;<span>23.3</span></a> and <a href="../mdps/lipschitz-mdps.html#thm-lipschitz-opt">Theorem&nbsp;<span>17.1</span></a>.</p></li>
</ol>
</div>
</div>
</div>
</section>
<section id="example-inventory" class="level2 page-columns page-full" data-number="23.3">
<h2 data-number="23.3" class="anchored" data-anchor-id="example-inventory"><span class="header-section-number">23.3</span> Example: Inventory management with incorrect demand distribution</h2>
<p>Let’s consider the <a href="../mdps/inventory-management-revisited.html">inventory management</a> problem. Suppose that the demand process has a PDF <span class="math inline">\(f_W\)</span> but we choose a policy <span class="math inline">\(\hat π^*\)</span> according to an estimated demand PDF <span class="math inline">\(f_{\hat W}\)</span>. What is the model approximation error if the policy <span class="math inline">\(\hat π^*\)</span> is used instead of <span class="math inline">\(π^*\)</span>?</p>
<div class="page-columns page-full"><p>To upper bound the model approximation error, we use the instance independent bounds of <a href="#cor-model-error-instance-independent">Corollary&nbsp;<span>23.1</span></a> in terms of the Wasserstein distance. Note that since there is no error in modeling the per-step cost, <span class="math inline">\(ε = 0\)</span>. To bound <span class="math inline">\(δ\)</span>, note that pdf of the dynamics are given by: <span class="math display">\[
  p(\cdot | s,a) = f_W(\cdot -s+a)
\]</span> which is the same as the demand distribution shifted by <span class="math inline">\((s-a)\)</span>. Thus, <span class="math display">\[
  \ALPHABET K(p(\cdot | s,a), \hat p(\cdot | s,a))
  =
  \ALPHABET K(f_W(\cdot - s + a), f_{\hat W}(\cdot - s + a))
  =
  \ALPHABET K(f_W, f_{\hat W})
\]</span> where the last equality uses the fact that shifting two distributions does not change their Wasserstein distance<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Thus, <span class="math display">\[
  δ = \ALPHABET K(f_W, f_{\hat W})
\]</span> is the Wasserstein distance between the</p><div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;For our 1-dimension setting, this fact can be seen immediately from the formula of Wasserstein distance in terms of the CDF of random varaibles: <span class="math display">\[
  \ALPHABET K(X,Y) = \int_{-∞}^∞ \ABS{ F_X(t) - F_Y(t) } dt.
\]</span> For a more general argument, see the next section.</p></li></div></div>
<p>We know from <a href="../mdps/lipschitz-mdps.html#exm-lipschitz-inventory">Example&nbsp;<span>17.1</span></a> that the inventory management model is <span class="math inline">\((p + \max\{c_h,cs\}, 1)\)</span>-Lipschitz. Therefore, the approximate value function <span class="math inline">\(\hat V^*\)</span> is <span class="math inline">\(\hat L_V\)</span>-Lipschitz (see <a href="../mdps/lipschitz-mdps.html#thm-lipschitz-opt">Theorem&nbsp;<span>17.1</span></a>) with <span class="math display">\[
  \hat L_V \le \frac{p + \max\{c_h, c_s\}}{1 - γ}.
\]</span></p>
<p>Therefore, we get that the policy <span class="math inline">\(\hat π^*\)</span> is <span class="math inline">\(α\)</span>-optimal, where <span class="math display">\[
  α \le \frac{2 γ}{(1-γ)^2}(p + \max\{c_h, c_s\}) \ALPHABET K(f_W, f_{\hat W}).
\]</span></p>
</section>
<section id="example-certainty-equivalence" class="level2" data-number="23.4">
<h2 data-number="23.4" class="anchored" data-anchor-id="example-certainty-equivalence"><span class="header-section-number">23.4</span> Example: Performance loss in using certainty equivalent control</h2>
<p><a href="../stochastic-optimization/certainty-equivalence.html">Certainty equivalence</a> refers to the following design methodology to determine a control policy for a stochastic control problem. Replace the random variables in the stochastic control problem by their (conditional) expectations, solve the resulting deterministic control problem to determine a feedback control policy, and use the resulting <em>certainty equivalent control policy</em> in the original stochastic system. See notes on <a href="../linear-systems/lqr.html">linear quadratic regulation</a> for an example where certainty equivalence is optimal.</p>
<p>But this is not the case in general. In this section, we use the results of <a href="#thm-model-error-IPM">Theorem&nbsp;<span>23.3</span></a> to characterize the performance loss when using certainty equivalence for general models.</p>
<p>Consider a system with state space <span class="math inline">\(\reals^n\)</span>, action space <span class="math inline">\(\reals^m\)</span>, and dynamics <span class="math display">\[\begin{equation}\label{eq:stochastic}
    S_{t+1} = f(S_t, A_t) + N_t
\end{equation}\]</span> where <span class="math inline">\(f\)</span> is a measurable function and <span class="math inline">\(\{N_t\}_{t \ge 1}\)</span> is a zero-mean i.i.d.&nbsp;noise sequence with control law <span class="math inline">\(\nu_N\)</span>. The per-step cost is given by <span class="math inline">\(c(S_t, A_t)\)</span>.</p>
<p>Now consider a deterministic model obtained by assuming that the noise sequence in <span class="math inline">\(\eqref{eq:stochastic}\)</span> takes its expected value, i.e., the dynamics are <span class="math display">\[\begin{equation}\label{eq:deterministic}
    S_{t+1} = f(S_t, A_t).
\end{equation}\]</span> The per-step cost is the same as before.</p>
<p>Let <span class="math inline">\(\ALPHABET M\)</span> denote the stochastic model and <span class="math inline">\(\hat {\ALPHABET M}\)</span> denote the deterministic model. Then, the certainty equivalent design is to use the control policy <span class="math inline">\(\hat \pi^*\)</span> in original stochastic model <span class="math inline">\(\ALPHABET M\)</span>. We use the Wasserstein distance based bounds in <a href="#cor-model-error-instance-independent">Corollary&nbsp;<span>23.1</span></a> to bound <span class="math inline">\(\NORM{V^{\hat \pi^*} - V^*}_{∞}\)</span>. We assume that there is some norm <span class="math inline">\(\| \cdot \|\)</span> on <span class="math inline">\(\reals^n\)</span> and the Wasserstein distance and Lipschitz constant are computed with respect to this norm.</p>
<p>Since the costs are the same for both models, <span class="math inline">\(ε = 0\)</span>. We now characterize <span class="math inline">\(\delta\)</span>. For ease of notation, given random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> with probability laws <span class="math inline">\(\nu_X\)</span> and <span class="math inline">\(\nu_Y\)</span>, we will use <span class="math inline">\(\ALPHABET K(X,Y)\)</span> to denote <span class="math inline">\(\ALPHABET K(\nu_X, \nu_Y)\)</span>. Recall the Kantorovich-Rubinstein inequality <span class="citation" data-cites="Villani2008">Villani et al. (<a href="../references.html#ref-Villani2008" role="doc-biblioref">2008</a>)</span>, which states that <span class="math display">\[\begin{equation}\label{eq:Kantorovich}
    \ALPHABET K(\nu_X, \nu_Y) = \inf_{ \substack{ \tilde X \sim \nu_X \\ \tilde Y \sim \nu_Y} }
    \EXP[ \| \tilde X - \tilde Y \| ]
\end{equation}\]</span> Now, for a fixed <span class="math inline">\((s,a)\)</span>, define <span class="math inline">\(X = f(s,a) + N\)</span>, where <span class="math inline">\(N \sim \nu_N\)</span>, and <span class="math inline">\(Y = f(s,a)\)</span>. Then, the Wasserstein distance between <span class="math inline">\(P(\cdot | s,a)\)</span> and <span class="math inline">\(\hat P(\cdot | s,a)\)</span> is equal to <span class="math inline">\(\ALPHABET K(X,Y)\)</span>, which by Kantorovich-Rubinstein inequality <span class="math inline">\(\eqref{eq:Kantorovich}\)</span>, equals <span class="math inline">\(\EXP[\| N \|]\)</span>, which does not depend on <span class="math inline">\((s,a)\)</span>. Thus, <span class="math display">\[
  δ = \EXP[\NORM{N}].
\]</span></p>
<p>Thus, by <a href="#cor-model-error-instance-independent">Corollary&nbsp;<span>23.1</span></a>, we get <span class="math display">\[\begin{equation}\label{eq:CE-bound}
    \NORM{ V^{\hat \pi^*} - V^*}_{∞} \le \frac{2\gamma}{1- \gamma} \EXP[ \| N \| ] L_{\hat V^*}.
\end{equation}\]</span> This bound precisely quantifies the engineering intuition that certainty equivalent control laws are good when the noise is “small”. This bound may be viewed as a generalization of the bounds on <a href="../stochastic-optimization/certainty-equivalence.html">certainty equivalence for stochastic optimization</a> presented earlier.</p>
<!--
## Example: State aggregation (or discretization or quantization)

Consider an MDP $\ALPHABET M = \langle \ALPHABET S, \ALPHABET A, p, c, γ
\rangle$, with large (or possibly continuous) state space. For simplicity, we
assume that $\ALPHABET S$ is continuous (and compact), and that the $p$ is the
density of the transition kernel. Note that we are using the term "probability
density" in the engineering sense (so, it may be a combination of a continuous
function and delta functions) rather than in the precise measure theoretic
sense (where it is the Radon-Nikodym derivative with respect to the Lebesgue
measure).

If exact computations were possible, we can find an optimal solution by
solving a dynamic program. However, since the state space is continuous, we
cannot compute the value functions exactly. The simplest way to proceed is to
discretize or quantize the state space $\ALPHABET S$. In particular, let
$\{\ALPHABET S_1, \dots \ALPHABET S_n\}$ denote a partition of $\ALPHABET S$
(i.e., $\bigcup_{i=1}^n \ALPHABET S_i = \ALPHABET S$ and for any $i \neq j$,
$\ALPHABET S_i \cap \ALPHABET S_j = \emptyset$). Pick a representative point
$\hat s_i \in \ALPHABET S_i$. We can think of the "grid points" $\hat
{\ALPHABET S} = \{\hat s_1, \dots, \hat s_n\}$ as quantization of the state
space $\ALPHABET S$. To simplify the notation, we define a quantization
function $\phi \colon \ALPHABET S \to \hat {\ALPHABET S}$ which maps all
points in $\ALPHABET S_i$ to the representative element $\hat s_i$. 

We consider a finite state MDP $\widehat {\ALPHABET M} = \langle \hat
{\ALPHABET S}, \ALPHABET A, \hat P, \hat c, γ\rangle$, where $\hat c$ is the
restriction of $c$ onto $\hat {\ALPHABET S}$, and $\hat P$ is given by 

$$\hat P(\hat s_j | \hat s_i, a) =
\int_{\ALPHABET S_j} P(s' | \hat s_i, a) ds' = P(\ALPHABET S_j | \hat s_i, a),
\quad \forall \hat s_i, \hat s_j \in \hat {\ALPHABET S}.
$$


Since model $\widehat {\ALPHABET M}$ is discrete, we can find the optimal
value function and policy using dynamic programming. 
We are interested in the questions of quantifying the errors in value
approximation and policy approximation in this setup. Since the quantized
model is defined on a state space $\hat {\ALPHABET S}$ that is different from
the original state space, the approximation bounds derived above are not
directly applicable. Below we present two intermediate models, to be able to
compare models $\ALPHABET M$ and $\widehat {\ALPHABET M}$

### An intermediate model

Define a model $\overline {\ALPHABET M} = \langle \ALPHABET S, \ALPHABET A, 
\bar p, \bar c, γ \rangle$, where
$$
  \bar c(s,a) = c(\phi(s),a)
$$
and
$$
  \bar p(s'|s,a) = p(s'|\phi(s),a).
$$

We have the following property for the $\bar p$ dynamics:

:::{#lem-aggregation-models}
For any $\hat V \colon \hat {\ALPHABET S} \to \reals$, let $V \colon
\ALPHABET S \to \reals$ be its piecewise constant extrapolation from
$\hat {\ALPHABET S}$ to $\ALPHABET S$ (i.e., $V = \hat V \circ \phi$).
Then, for any $\hat s \in \ALPHABET S$ and $a \in \ALPHABET A$, we have
$$
\int_{\ALPHABET S_j} \bar p(s'|\hat s, a) V(s') ds' 
=
\hat P(\hat s_j | \hat s, a) \hat V(\hat s_j).
$$
Therefore, 
$$
\int_{\ALPHABET S} \bar p(s'|\hat s, a) V(s') ds' 
=
\sum_{\hat s' \in \hat {\ALPHABET S}} \hat P(\hat s' | \hat s, a) \hat V(\hat s').
$$
:::

:::{.callout-note collapse="true"} 
#### Proof {-}
Since $V$ is constant over $\ALPHABET S_j$, we have
\begin{align*}
  \int_{\ALPHABET S_j} \bar p(s'|\hat s,a) V(s') ds' 
  &=
  V(\hat s_j) \int_{\ALPHABET S_j} \bar p(s'|\hat s,a) ds' 
  \notag \\
  &= V(\hat s_j) \bar p(\ALPHABET S_j | \hat s, a)
\end{align*}
The first result now follows from observing that $\bar p(\ALPHABET S_j | \hat
s, a) = p(\ALPHABET S_j | \hat s, a) = \hat P(\hat s_j | \hat s, a)$. The
second result follows from the fact that for any $f \colon \ALPHABET S \to
\reals$, 
$$
  \int_{\ALPHABET S} f(s')  ds' = \int_{\ALPHABET S_1} f(s') ds' + \cdots +
  \int_{\ALPHABET S_n} f(s') d(s').
$$
:::


Let $\bar V^*$, and $\hat V^*$ denote the optimal value functions of models
$\overline {\ALPHABET M}$ and $\widehat {\ALPHABET M}$, respectively.
Moreover, let $\bar π^*$ and $\hat π^*$ denote optimal policies of models
$\widehat {\ALPHABET M}$, and $\overline {\ALPHABET M}$, respectively. Then,
these are related as follows.

:::{#lem-aggregation-equiv}
$\bar V^*$ is a piecewise constant extrapolation of $\hat V^*$ from
$\hat {\ALPHABET S}$ to $\ALPHABET S$. Moreover, the piecewise constant
extrapolation of $\hat π^*$ is optimal for model $\overline {\ALPHABET
M}$. 
:::

:::{.callout-note collapse="true"}  
#### Proof {-}
Let $\bar V$ be the piecewise constant extrapolation of $\hat V^*$ from $\hat
{\ALPHABET S}$ to $\ALPHABET S$. @lem-aggregation-models implies that for any $s \in
\ALPHABET S$, the one step Bellman update of $\bar V$ (in model $\overline
{\ALPHABET M}$) is given by
\begin{align*}
  \min_{a \in \ALPHABET S} \biggl\{
    c(\phi(s),a) + γ \int_{\ALPHABET S} \bar p(s'|\phi(s),a) \bar V(s') ds'
  \biggr\}
  &= 
  \min_{a \in \ALPHABET S} \biggl\{
    \hat c(\phi(s),a) + γ \sum_{\hat s' \in \hat {\ALPHABET S}} 
    \hat P(\hat s' | \phi(s), a) \hat V^*(\hat s')
  \biggr\}
  \\
  &=
  \hat V^*(\phi(s)) 
  \\
  &= \bar V(s)
\end{align*}
where the first equality follows from @lem-aggregation-models, the second equality
follows from the fact that $\hat V^*$ is optimal for model $\widehat
{\ALPHABET M}$, and the last equality follows from the definition of $\bar V$.
Thus, $\bar V$ is the fixed point of the Bellman optimality equation for model
$\overline {\ALPHABET M}$. Hence, $\bar V = \bar V^*$. 

The above equation also implies that the policy $\hat π^*(\phi(s))$, which
achieves the arg min in the second equality, is optimal for model
$\overline{\ALPHABET M}$. 
:::

:::{.callout-tip}
### Remark
@lem-aggregation-equiv implies that the questions of value and policy
approximation for model $\widehat {\ALPHABET M}$ is the same as those for
model $\overline {\ALPHABET M}$. The advantage of working with model
$\overline {\ALPHABET M}$ is that it is defined on the same state space as
model $\ALPHABET M$, so we can directly use the results of @thm-mismatch-policy-bound and @thm-mismatch-policy-bound2.
:::

### Approximation bounds

Now to bound the value error between models $\ALPHABET M$ and $\overline
{\ALPHABET M}$, we need to compute $\MISMATCH^* V^*$, which is given by
\begin{align*}
  \MISMATCH^* V^* &= 
  \max_{s \in \ALPHABET S}
  \biggl| 
    \min_{a \in \ALPHABET A} \bigl\{ 
    c(s,a) + γ \int_{\ALPHABET S} p(s'|s,a) V^*(s')ds'
    \bigr\}
    \notag \\
  &  \hskip 4em -
    \min_{a \in \ALPHABET A} \bigl\{ 
   c(\phi(s), a) + γ \int_{\ALPHABET S} p(s'|\phi(s), a) V^*(s') ds' 
    \bigr\}
  \biggr|
  \notag \\
  &= \max_{s \in \ALPHABET S} \bigl| V^*(s) - V^*(\phi(s)) \bigr|
  =: H_{\max}.
\end{align*}

Therefore, from @thm-mismatch-value-bound, we have

:::{#prp-aggregation-value}
$$ \| V^* - \bar V^{\bar π^*} \|_∞ \le \frac{H_{\max}}{1-γ}. $$
:::

To bound the policy error, we also need to compute $\MISMATCH^{\hat π^*}
V^*$. In order to compute this bound, we assume that the model is $(L_c, L_p)$
Lipschitz. 


Assumpt. #ass:lip

:   * For every $a \in \ALPHABET A$, $c(s, a)$ is $L_c$-Lipschitz in $s$
    * For every $a \in \ALPHABET A$, $p(\cdot | s, a)$ is $L_p$-Lipschitz
      in $s$ (with respect to the Kantorovich distance on probability measures). 

Under this assumption, we have

\begin{align*}
  \MISMATCH^{\bar π^*} V^* &\le \max_{s \in \ALPHABET S}
  \sum_{a \in \ALPHABET A} \bar π^*(a | s) \biggl|
    c(s,a) + γ \int_{\ALPHABET S} p(s'|s,a) V^*(s')ds'
  \notag \\
  &  \hskip 4em -
    c(\phi(s), a) - γ \int_{\ALPHABET S} p(s'|\phi(s), a) V^*(s') ds' 
  \biggr|
  \notag \\
  &\le  L_c \max_{s \in \ALPHABET S}d(s, \phi(s)) 
  + 
  γ K(p(\cdot | s, a), p(\cdot | \phi(s), a)) \NORM{V^*}_L )
  \notag \\
  &\le ( L_c  + γ L_p \NORM{V^*}_L ) 
  \underbrace{\max_{s \in \ALPHABET S}d(s, \phi(s)) }_{=: D}
\end{align*}
where the second inequality uses @prp-Kantorovich.

Thus, we have the following:

::: highlight :::
Proposition #prop:policy-aggregation

:   Under @ass:lip, we have
    $$\NORM{V^* - V^{\bar π^*}}_∞ \le 
      \frac{D}{1-γ} \biggl[ L_c + γ L_p \NORM{V^*}_L + 
      \frac{1 + γ}{1-γ} \NORM{V^*}_L \biggr]. $$

    [LP]: ../lipschitz-mdp#thm:Lipschitz-opt

    Furthermore, if $γ L_p < 1$, then from [Theorem 1 of Lipschitz MDPs][LP]
    we know that $\NORM{V^*}_L \le L_c/(1- γ L_p)$. Thus,
    $$\NORM{V^{μ^*} - V^*}_∞ \le 
      \frac{2 D L_c }{ (1-γ)^2 (1-γ L_p) }. $$

:::

#### Proof {-}
<div>
The first bound follows from @thm:policy-bound2, with the additional
observation that $H_{\max} \le \NORM{V^*}_L D$. 

For the second result follows from simple algebra.
</div>
-->
</section>
<section id="notes" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="notes">Notes</h2>
<p>The material in this section is adapted from <span class="citation" data-cites="Bozkurt2023">Bozkurt et al. (<a href="../references.html#ref-Bozkurt2023" role="doc-biblioref">2023</a>)</span>, where the results were presented for unbounded per-step cost. The IPM-based bounds of <a href="#thm-model-error-IPM">Theorem&nbsp;<span>23.3</span></a> are due to <span class="citation" data-cites="Muller1997a">Müller (<a href="../references.html#ref-Muller1997a" role="doc-biblioref">1997</a>)</span>, but the proof is adapted from <span class="citation" data-cites="Bozkurt2023">Bozkurt et al. (<a href="../references.html#ref-Bozkurt2023" role="doc-biblioref">2023</a>)</span>, where some generalizations of <a href="#thm-model-error-IPM">Theorem&nbsp;<span>23.3</span></a> are also presented.</p>
<p>The approximation bound for the <a href="#example-inventory">inventory management example</a> is from <span class="citation" data-cites="Muller1997a">Müller (<a href="../references.html#ref-Muller1997a" role="doc-biblioref">1997</a>)</span>. The approximation bound for <a href="#example-certainty-equivalence">certainty equivalence</a> is from <span class="citation" data-cites="Bozkurt2023">Bozkurt et al. (<a href="../references.html#ref-Bozkurt2023" role="doc-biblioref">2023</a>)</span>.</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-Bozkurt2023" class="csl-entry" role="listitem">
<span class="smallcaps">Bozkurt, B., Mahajan, A., Nayyar, A., and Ouyang, Y.</span> 2023. Weighted norm bounds in MDPs with unbounded per-step cost.
</div>
<div id="ref-Muller1997a" class="csl-entry" role="listitem">
<span class="smallcaps">Müller, A.</span> 1997. Integral probability metrics and their generating classes of functions. <em>Advances in Applied Probability</em> <em>29</em>, 2, 429–443. DOI: <a href="https://doi.org/10.2307/1428011">10.2307/1428011</a>.
</div>
<div id="ref-Villani2008" class="csl-entry" role="listitem">
<span class="smallcaps">Villani, C. et al.</span> 2008. <em>Optimal transport: Old and new</em>. Springer.
</div>
</div>
</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../approx-mdps/policy-loss.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Upper bounds on policy loss</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../risk-sensitive/risk-sensitive-utility.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Risk Sensitive Utility</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>